---
layout: post
title: X-notifier ZJU邮箱脚本
description: ""
category: tools
tags: [js]

---
{% include JB/setup %}


一年前写的X-notifier 的浙大邮箱脚本，最近又修改了下，长时间开启浏览器也不会出现sid timeout了。

## X-notifier
X-notifier 是一个邮箱提醒浏览器插件，支持多邮箱（官网script），也可以自己编写script支持更多邮箱。


{% highlight js %}
## ZJUMail.js

/**********************************************************
ZJUMail
**********************************************************/
var name="ZJUMail";
var ver="2013-011-18";

function init(){
  this.loginData=["http://mail.zju.edu.cn/coremail/index.jsp","uid","password","action%3Alogin="];
 
  this.dataURL="http://mail.zju.edu.cn/coremail/XJS/index.jsp?";
  this.viewURL="http://mail.zju.edu.cn/coremail/XJS/index.jsp?";
 
}
function getIconURL(){
  return "http://mail.zju.edu.cn/favicon.ico";
}
function getCount(aData){
  var fnd=aData.match(/navNewCount_1\">\((\d+)\)<\/span>/);
  var checked=aData.indexOf('fNewMail');
  if(checked == -1){
    return -1;
  }
  return fnd?fnd[1]:0;
}

function process(aData,aHttp) {
   switch(this.stage){
    case ST_LOGIN_RES:{
      var fnd=aData.match(/sid=\w+/);
      if(fnd){
        this.viewURL="http://mail.zju.edu.cn/coremail/XJS/index.jsp?"+fnd;
        this.dataURL=this.viewURL;
      }
    }
    
  }
  return this.baseProcess(aData,aHttp);
}
{% endhighlight %}


##参考：
<http://xnotifier.tobwithu.com/dp>